<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cashier System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        header h1 {
            margin: 0;
        }
        header button {
            background-color: white;
            color: #4CAF50;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
        }
        header button:hover {
            background-color: #e0e0e0;
        }
        main {
            padding: 20px;
            max-width: 800px;
            margin: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .table-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .table-buttons button {
            padding: 15px;
            background-color: #f4f4f9;
            border: 1px solid #ccc;
            font-size: 14px;
        }
        .table-buttons button:hover {
            background-color: #e0e0e0;
        }
        #selectedTable {
            font-weight: bold;
            margin-bottom: 20px;
        }
        .menu {
            display: flex;
            gap: 20px;
        }
        .menu-column {
            flex: 1;
        }
        .menu-column h3 {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            margin: 0 0 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        #addCustomItem {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        #addCustomItem input {
            padding: 8px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #addCustomItem button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        #addCustomItem button:hover {
            background-color: #45a049;
        }
        #orderHistoryModal {
            position: fixed;
            top: 10%;
            left: 50%;
            transform: translate(-50%, 0);
            width: 80%;
            max-width: 600px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            padding: 20px;
            display: none;
        }
        #orderHistoryModal h2 {
            margin-top: 0;
        }
        #orderHistoryModal table {
            width: 100%;
            border-collapse: collapse;
        }
        #orderHistoryModal th, #orderHistoryModal td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        #closeHistory {
            float: right;
            cursor: pointer;
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <header>
        <h1>Cashier System</h1>
        <button onclick="toggleOrderHistory()">Order History</button>
    </header>
    <main>
        <div id="tableSelection">
            <h2>Select Table</h2>
            <div class="table-buttons">
                <button onclick="selectTable(1)">Table 1</button>
                <button onclick="selectTable(2)">Table 2</button>
                <button onclick="selectTable(3)">Table 3</button>
                <button onclick="selectTable(4)">Table 4</button>
                <button onclick="selectTable(5)">Table 5</button>
            </div>
        </div>

        <p id="selectedTable">Selected Table: None</p>

        <div id="menuSection" class="hidden">
            <div class="menu">
                <div class="menu-column">
                    <h3>Prices</h3>
                    <div class="table-buttons">
                        <button onclick="addItem(null, 3.50)">$3.50</button>
                        <button onclick="addItem(null, 5.90)">$5.90</button>
                        <button onclick="addItem(null, 13.90)">$13.90</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="addCustomItem" class="hidden">
            <h3>Add Custom Price</h3>
            <input type="number" id="customPrice" placeholder="Enter Price" step="0.01" min="0">
            <button onclick="addCustomPrice()">Add</button>
        </div>

        <div id="orderSummary" class="hidden">
            <h2>Order Summary</h2>
            <table>
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Price</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="orderTable"></tbody>
            </table>
            <p id="totalPriceCash">Total (Cash): $0.00</p>
            <p id="totalPriceCard">Total (Card, +2.5%): $0.00</p>
            
            <button id="cardPayButton" onclick="processPayment('card')">Card Pay</button>
        </div>

        <!-- Cash Payment Input -->
        <div id="cashPaymentInput" class="hidden">
            <label for="cashGiven">Enter Amount Given:</label>
            <input type="number" id="cashGiven" placeholder="Enter amount given" step="0.01" min="0">
            <button id="cashPayButton" onclick="processPayment('cash')">Cash Pay</button>
        </div>
        <p id="changeAmount" class="hidden">Change: $0.00</p>
    </main>

    <div id="orderHistoryModal">
        <span id="closeHistory" onclick="toggleOrderHistory()">X</span>
        <h2>Order History</h2>
        <table>
            <thead>
                <tr>
                    <th>Table</th>
                    <th>Amount</th>
                    <th>Payment Method</th>
                    <th>Time</th>
                </tr>
            </thead>
            <tbody id="orderHistoryTable"></tbody>
        </table>
    </div>

    <script>
        let orders = {};
        let selectedTable = null;
        let orderHistory = [];

        function selectTable(tableNumber) {
            selectedTable = tableNumber;
            document.getElementById('selectedTable').textContent = `Selected Table: ${tableNumber}`;
            document.getElementById('menuSection').classList.remove('hidden');
            document.getElementById('orderSummary').classList.remove('hidden');
            document.getElementById('addCustomItem').classList.remove('hidden');
            renderOrderTable();
        }

        function addItem(name, price) {
            if (!orders[selectedTable]) {
                orders[selectedTable] = [];
            }
            orders[selectedTable].unshift({ name: name || 'Custom Item', price });
            renderOrderTable();
        }

        function addCustomPrice() {
            const price = parseFloat(document.getElementById('customPrice').value);
            if (!isNaN(price) && price > 0) {
                addItem(null, price);
                document.getElementById('customPrice').value = '';
            } else {
                alert('Please enter a valid price.');
            }
        }

        function renderOrderTable() {
            const tableBody = document.getElementById('orderTable');
            tableBody.innerHTML = '';

            let total = 0;
            if (orders[selectedTable]) {
                orders[selectedTable].forEach((item, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = 
                        `<td>${item.name}</td>
                        <td>$${item.price.toFixed(2)}</td>
                        <td><button onclick="removeItem(${index})">Remove</button></td>`;
                    tableBody.appendChild(row);
                    total += item.price;
                });
            }

            const cardTotal = (total * 1.025).toFixed(2);
            document.getElementById('totalPriceCash').textContent = `Total (Cash): $${total.toFixed(2)}`;
            document.getElementById('totalPriceCard').textContent = `Total (Card, +2.5%): $${cardTotal}`;
        }

        function removeItem(index) {
            orders[selectedTable].splice(index, 1);
            renderOrderTable();
        }

        function processPayment(method) {
            const total = parseFloat(method === 'cash' 
                ? document.getElementById('totalPriceCash').textContent.split('$')[1] 
                : document.getElementById('totalPriceCard').textContent.split('$')[1]);

            if (method === 'cash') {
                const cashGiven = parseFloat(document.getElementById('cashGiven').value);
                if (isNaN(cashGiven) || cashGiven < total) {
                    alert('Please enter a valid amount given by the customer (greater than or equal to the total).');
                    return;
                }
                const change = (cashGiven - total).toFixed(2);
                document.getElementById('changeAmount').textContent = `Change: $${change}`;
                document.getElementById('changeAmount').classList.remove('hidden');
            }

            const now = new Date();
            const time = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;

            // Record order in the order history
            orderHistory.push({
                table: selectedTable,
                amount: `$${total.toFixed(2)}`,
                paymentMethod: method === 'cash' ? 'Cash' : 'Card',
                time
            });

            // Reset the order
            orders[selectedTable] = [];
            renderOrderTable();
        }

        function toggleOrderHistory() {
            const modal = document.getElementById('orderHistoryModal');
            modal.style.display = modal.style.display === 'block' ? 'none' : 'block';

            const orderHistoryTable = document.getElementById('orderHistoryTable');
            orderHistoryTable.innerHTML = '';

            orderHistory.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = 
                    `<td>${order.table}</td>
                    <td>${order.amount}</td>
                    <td>${order.paymentMethod}</td>
                    <td>${order.time}</td>`;
                orderHistoryTable.appendChild(row);
            });
        }
    </script>
</body>
</html>
